# Integration test configuration for keychain server
# Enables ALL protocols for comprehensive testing

server:
  host: "0.0.0.0"
  rest_port: 8443
  grpc_port: 9443
  quic_port: 8444
  mcp_port: 9444

# Enable ALL protocols for complete integration testing
protocols:
  unix: true    # Unix domain socket for local CLI
  rest: true    # REST/HTTP API
  grpc: true    # gRPC API
  quic: true    # QUIC/HTTP3 API
  mcp: true     # MCP JSON-RPC API

# Unix socket configuration
unix:
  socket_path: /var/run/keychain/keychain.sock
  socket_mode: "0660"

logging:
  level: "debug"
  format: "json"

# TLS disabled for integration tests
tls:
  enabled: false

# Auth disabled for integration tests
auth:
  enabled: false

ratelimit:
  enabled: false

metrics:
  enabled: true
  path: "/metrics"
  port: 9090

health:
  enabled: true
  path: "/health"

# Storage configuration
storage:
  backend: "filesystem"
  path: "/data/keychain"

# Default backend for key operations
default_backend: "software"

# Backend configurations
backends:
  software:
    enabled: true
    path: "/data/keychain/software"

  tpm2:
    enabled: false  # Disabled by default, can be enabled per test
    device_path: "tcp://swtpm:2321"

  pkcs11:
    enabled: false  # Disabled by default, can be enabled per test
    library: "/usr/local/lib/softhsm/libsofthsm2.so"
    token: "test-token"
    pin: "123456"
